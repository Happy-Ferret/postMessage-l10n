<html>
  <head>
    <meta charset="utf-8">
    <title>postFormattedEntity</title>

    <script src="locales/ast.js"></script>
    <script src="lib/entry.js"></script>
    <script src="lib/resolver.js"></script>

    <script>

      window.envEntries = Object.create(null);
      for (var i = 0, node; node = window.ast[i]; i++) {
        window.envEntries[node.$i] = createEntry(node, 'en-US', 'app');
      }

      window.ast = null;
      delete window.ast;

      function receive(evt) {
        var formatted = format(window.envEntries[evt.data.id]);
        evt.source.postMessage(formatted, '*');
      }

      window.addEventListener('message', receive);

    </script>
  </head>

  <body>
    <p>Send each formatted entity individually</p>
    <iframe height="100" src="views/postFormattedEntity.html"></iframe>
    <iframe height="100" src="views/postFormattedEntity.html"></iframe>
    <iframe height="100" src="views/postFormattedEntity.html"></iframe>
    <iframe height="100" src="views/postFormattedEntity.html"></iframe>
    <iframe height="100" src="views/postFormattedEntity.html"></iframe>
  </body>
</html>
